<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multiple Covariate Balance Assessment Plot — cv.bal.psa • PSAgraphics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multiple Covariate Balance Assessment Plot — cv.bal.psa"><meta property="og:description" content="Provides a graphic that depicts covarite effect size differences between
treatment groups both before and after stratification.  Function will create
stata internally if desired, and returns numerical output used to create
graphic."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PSAgraphics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jbryer/PSAgraphics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiple Covariate Balance Assessment Plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/jbryer/PSAgraphics/blob/HEAD/R/cv.bal.psa.R" class="external-link"><code>R/cv.bal.psa.R</code></a></small>
    <div class="hidden name"><code>cv.bal.psa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Provides a graphic that depicts covarite effect size differences between
treatment groups both before and after stratification.  Function will create
stata internally if desired, and returns numerical output used to create
graphic.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cv.bal.psa</span><span class="op">(</span></span>
<span>  <span class="va">covariates</span>,</span>
<span>  <span class="va">treatment</span>,</span>
<span>  <span class="va">propensity</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  int <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tree <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  minsize <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  universal.psd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trM <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  absolute.es <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trt.value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use.trt.var <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot.strata <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>covariates</dt>
<dd><p>Dataframe of covariates.  Factors should be recoded using
<code>cv.trans.psa</code></p></dd>


<dt>treatment</dt>
<dd><p>Binary vector or factor defining the two treatments</p></dd>


<dt>propensity</dt>
<dd><p>Vector of same length as <code>treatment</code> containing
estimated propensity scores.</p></dd>


<dt>strata</dt>
<dd><p>Either a vector of same length as <code>treatment</code> of
predefined stratum number, or one integer <code>n</code> used to assign rows to
<code>n</code> strata <code>propensity</code> scores, each of approximately the same
number of cases. If relatively few unique propensity scores have been
defined (as from a classification tree) then the logical <code>tree</code> should
be set equal to <code>TRUE</code>.</p></dd>


<dt>int</dt>
<dd><p>Either a number <code>m</code> used to divide <code>[0,1]</code> into
<code>m</code> equal length subintervals, or a vector containing cut points
between 0 and 1 that define subintervals (perhaps as suggested by
loess.psa). In either case the subintervals define strata, for which sizes
can differ.</p></dd>


<dt>tree</dt>
<dd><p>Logical, default <code>FALSE</code>.  If there are few unique
propensity scores, say from a recursively partitioned tree, then TRUE forces
strata to be defined by the unique propensity scores.</p></dd>


<dt>minsize</dt>
<dd><p>Smallest allowable stratum-treatment size.  If violated, rows
in the stratum are removed.  User may wish to redefine strata.</p></dd>


<dt>universal.psd</dt>
<dd><p>Logical, default = TRUE.  Forces standard deviations
used to be unadjusted for stratification.</p></dd>


<dt>trM</dt>
<dd><p>Numeric, default = 0; passed to <code>mean</code> for trimming
purposes.</p></dd>


<dt>absolute.es</dt>
<dd><p>Logical, default TRUE. If TRUE, graphic depicts absolute
values of all effect sizes.  Note that the adjusted effect size plotted is
the absolute value of weighted averages of the signed by-stratum effect size
values when <code>absolute.es</code> is TRUE.</p></dd>


<dt>trt.value</dt>
<dd><p>Character string; if desired allows the name of an active
treatment to be given.  Should be a level (value) of the <code>treatment</code>
factor (vector).</p></dd>


<dt>use.trt.var</dt>
<dd><p>Logical, default FALSE.  If TRUE, uses just active
treatment standard deviations for effect size, as per a suggestion of Rubin
and Stuart (see reference below).</p></dd>


<dt>verbose</dt>
<dd><p>Logical, default FALSE.  Numerical output is returned
invisibly.</p></dd>


<dt>xlim</dt>
<dd><p>Binary vector passed to plot for overriding default choices.
Default NULL.</p></dd>


<dt>plot.strata</dt>
<dd><p>Logical, default TRUE.  Adds effect size values for
individual strata to graphic.</p></dd>


<dt>...</dt>
<dd><p>Other graphical parameters passed to <code>plot</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Graphic plots covariate balance before and after stratication on
propensity scores.  The default version (absolute.es = TRUE) plots the
absolute values of effect sizes for each stratum, though the overall
estimate is the weighted mean before taking the absolute values.  Numerical
output consists of seven addressable objects.  If <code>verbose</code> is FALSE
(default), output is not printed.</p>
<dl><dt>original.strata</dt>
<dd><p>Matrix of
strata-treatment counts as originally input.</p></dd>
 <dt>strata.used</dt>
<dd><p>Matrix of
strata-treatment counts used in effectsize calculations after any
<code>minsize</code> reductions.</p></dd>
 <dt>mean.diff.strata.wtd</dt>
<dd><p>Matrix of strata by
covariate weighted (by strata size) average differences.</p></dd>

<dt>mean.diff.unadj</dt>
<dd><p>Matrix of covariate effects sizes before
stratification.</p></dd>
 <dt>effect.sizes</dt>
<dd><p>Matrix of effect sizes by covariate and
statum.</p></dd>
 <dt>treatment.levels</dt>
<dd><p>Names of treatments.</p></dd>

<dt>effects.strata.treatment</dt>
<dd><p>Matrix of standard deviations and
stratum-treatment covariate means used to calculate the
<code>effect.sizes</code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Effect sizes between treatments for each covariate are presented in one
graphic, both before and after stratification.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>``Matching Methods for Causal Inference: A review and a look
forward." Forthcoming in Statistical Science.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>cv.bal.psa</code>, <code><a href="loess.psa.html">loess.psa</a></code>,
<code><a href="cstrata.psa.html">cstrata.psa</a></code>, <code><a href="cv.trans.psa.html">cv.trans.psa</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a></p>
<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a></p>
<p>KuangNan Xiong <a href="mailto:harryxkn@yahoo.com">harryxkn@yahoo.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lindner</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">lindner</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from lindner (pos = 3):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     abcix, acutemi, cardbill, diabetic, ejecfrac, female, height,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lifepres, stent, ves1proc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from lindner (pos = 4):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     abcix, acutemi, cardbill, diabetic, ejecfrac, female, height,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lifepres, stent, ves1proc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from lindner (pos = 5):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     abcix, acutemi, cardbill, diabetic, ejecfrac, female, height,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lifepres, stent, ves1proc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from lindner (pos = 6):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     abcix, acutemi, cardbill, diabetic, ejecfrac, female, height,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lifepres, stent, ves1proc</span>
<span class="r-in"><span><span class="va">lindner.ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">abcix</span> <span class="op">~</span> <span class="va">stent</span> <span class="op">+</span> <span class="va">height</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="va">diabetic</span> <span class="op">+</span> <span class="va">acutemi</span> <span class="op">+</span> <span class="va">ejecfrac</span> <span class="op">+</span> <span class="va">ves1proc</span>,</span></span>
<span class="r-in"><span>      data <span class="op">=</span> <span class="va">lindner</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span><span class="op">&lt;-</span><span class="va">lindner.ps</span><span class="op">$</span><span class="va">fitted</span></span></span>
<span class="r-in"><span><span class="va">lindner.cv</span> <span class="op">&lt;-</span> <span class="va">lindner</span><span class="op">[</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">cv.bal.psa</span><span class="op">(</span><span class="va">lindner.cv</span>, <span class="va">abcix</span>, <span class="va">ps</span>, strata <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cv.bal.psa-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">cv.bal.psa</span><span class="op">(</span><span class="va">lindner.cv</span>, <span class="va">abcix</span>, <span class="va">ps</span>, strata <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cv.bal.psa-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">cv.bal.psa</span><span class="op">(</span><span class="va">lindner.cv</span>, <span class="va">abcix</span>, <span class="va">ps</span>, int <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.5</span>, <span class="fl">.6</span>, <span class="fl">.75</span>, <span class="fl">.8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cv.bal.psa-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James Helmreich, Robert Pruzek, Jason Bryer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

