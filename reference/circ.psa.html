<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generates a Propensity Score Assessment Plot — circ.psa • PSAgraphics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generates a Propensity Score Assessment Plot — circ.psa"><meta property="og:description" content="Displays a graphic that summarizes outcomes in a propensity score analysis,
based on strata that have been defined in the first Phase of a propensity
score analysis (PSA).  The graphic displays contributions of individual
strata to the overall effect, weighing contributions of individual strata
according to the relative sizes of the respective strata. The overall effect
is plotted as a heavy dashed diagonal line that runs parallel to the
identity diagonal."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PSAgraphics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jbryer/PSAgraphics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generates a Propensity Score Assessment Plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/jbryer/PSAgraphics/blob/HEAD/R/circ.psa.R" class="external-link"><code>R/circ.psa.R</code></a></small>
    <div class="hidden name"><code>circ.psa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Displays a graphic that summarizes outcomes in a propensity score analysis,
based on strata that have been defined in the first Phase of a propensity
score analysis (PSA).  The graphic displays contributions of individual
strata to the overall effect, weighing contributions of individual strata
according to the relative sizes of the respective strata. The overall effect
is plotted as a heavy dashed diagonal line that runs parallel to the
identity diagonal.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">circ.psa</span><span class="op">(</span></span>
<span>  <span class="va">response</span>,</span>
<span>  treatment <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  summary <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  trim <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  revc <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  confint <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sw <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  ne <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  inc <span class="op">=</span> <span class="fl">0.25</span>,</span>
<span>  pw <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  lab <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  labcex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylab <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>response</dt>
<dd><p>Either a numeric vector containing the response of interest
in a propensity score analysis, or a three column array containing response,
treatment and strata.</p></dd>


<dt>treatment</dt>
<dd><p>Binary variable of same length as <code>response</code>;
generally 0 for 'control,' 1 for 'treatment'.  A character vector with two
labels or factor with two levels are also accepted.</p></dd>


<dt>strata</dt>
<dd><p>Generally integer variable; a vector of same length as
<code>response</code> indicating the derived strata from estimated propensity
scores. Generally 5 or 6 strata used, but function is effective for more
strata. In the case when strata are defined via unique propensity scores (as
from a tree), user may wish to define strata using <code>factor</code>.</p></dd>


<dt>summary</dt>
<dd><p>Logical (default <code>FALSE</code>).  If <code>TRUE</code> then
<code>response</code> must have rows corresponding to number of strata; the first
two columns should contain treatment and control group sizes for each
stratum, and the pair of columns should contain the appropriate summary
statistics for each statum.  For example, the four summary columns might
have been generated by the <code>strata.summary</code> output of <code>loess.psa</code>.</p></dd>


<dt>statistic</dt>
<dd><p>A scalar summary of the center of the response
distribution. Seen next item below.  Default = "mean".  Note that to
generate this statistic the full vector of responses must have been input,
not summaries.</p></dd>


<dt>trim</dt>
<dd><p>Allows for a trimmed mean as outcome measure, where trim is from
0 to .5 (.5 implying median).</p></dd>


<dt>revc</dt>
<dd><p>Logical; if <code>TRUE</code> then X and Y axes are interchanged in
plot.</p></dd>


<dt>confint</dt>
<dd><p>Logical; if <code>TRUE</code> adds an approximate 95% confidence
interval for the mean.  The interval may not be realistic it the <code>trim</code>
argument exceeds zero.</p></dd>


<dt>sw</dt>
<dd><p>Numerical argument (default = 0.4); extends axes on lower ends,
effectively moving circles to lower left.</p></dd>


<dt>ne</dt>
<dd><p>Numerical argument (default = 0.5); extends axes on upper ends,
effectively moving circles to upper right.</p></dd>


<dt>inc</dt>
<dd><p>Numerical argument (default = 0.35); controls circle sizes, but
relative circle sizes are controlled via <code>pw</code>. In general one wants
circle areas to appear subjectively to be sized in accordance with strata
sizes.</p></dd>


<dt>pw</dt>
<dd><p>numerical argument (default = 0.4); controls relative circle
sizes. <code>pw</code> denotes power or exponent for radius of circle.</p></dd>


<dt>lab</dt>
<dd><p>Logical (default TRUE); labels circles with stratum labels.</p></dd>


<dt>labcex</dt>
<dd><p>numerical argument (default = 1); controls the size of the
circle labels.</p></dd>


<dt>xlab</dt>
<dd><p>Label for horizontal axis, by default taken from
<code>treatment</code>.</p></dd>


<dt>ylab</dt>
<dd><p>Label for vertical axis, by default taken from <code>treatment</code>.</p></dd>


<dt>main</dt>
<dd><p>Main label for graph.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Generate a Propensity Assessment Plot, as well as numerical data for</p>
<dl><dt>summary.strata</dt>
<dd><p>An array with rows corresponding to strata and four
columns; these show counts for control and treatment groups, as well as
(possibly trimmed) mean response values for control and treatment.</p></dd>

<dt>wtd.Mn.(Name1)</dt>
<dd><p>Weighted mean of response for (Name1) group.  Name
taken from <code>treatment</code>.</p></dd>
 <dt>wtd.Mn.(Name2)</dt>
<dd><p>Weighted mean of
response for (Name2) group.  Name taken from <code>treatment</code>.</p></dd>

<dt>ATE</dt>
<dd><p>Average Treatment Effect.</p></dd>
 <dt>se.wtd</dt>
<dd><p>Weighted standard error
for <code>ATE</code></p></dd>
 <dt>approx.t</dt>
<dd><p>Ratio of the average treatement effect and a
standard error based on weighting of stratum variances.</p></dd>
 <dt>df</dt>
<dd><p>Estimate
of degree of freedom; response vector length minus twice number of strata.</p></dd>

<dt>CI.95</dt>
<dd><p>Approximate 95% confidence interval for overall effect size.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>A circle is plotted for each stratum, centered on the means for the
treatment and control groups (for the <code>X</code> and <code>Y</code> axes)
respectively. The sizes of the circles correspond to the relative sizes of
the strata. A diagonal line (lower left to upper right) shows the identity,
<code>X=Y</code>, so that circles on, say, the lower side of this line show that
the corresponding <code>X</code> mean is larger than the <code>Y</code> mean for that
stratum, and vice-versa. Parallel projections are made from the centers of
the strata-cum-circles to difference scores that are plotted on a line
segment on the lower-left corner of the graphic; the average difference,
which corresponds to the average treatment effect (ATE) for the overall
treatment effect, is plotted as a heavy (dark blue) dashed line parallel to
the identity diagonal. Rug plots are shown on the upper and right margins of
the graphic, for the <code>X</code> and <code>Y</code> marginal distributions. A 95%
confidence interval for the overall effect is plotted to the left of the
distribution of the stratum difference scores, centered on the ATE. Trimmed
means can replace the conventional mean for both the ATE and the marginal
distributions (however, the confidence interval calculations are likely to
become less trustworthy as larger values of the trim argument are used).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="loess.psa.html">loess.psa</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a></p>
<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Random data with effect size 0</span></span></span>
<span class="r-in"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">circ.psa</span><span class="op">(</span><span class="va">response</span>, <span class="va">treatment</span>, <span class="va">strata</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="circ.psa-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary.strata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n.0 n.1     means.0     means.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  77  90 -0.01466845 -0.04442946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  78  79 -0.06780324  0.26734417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  76  71 -0.17498127 -0.09495994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  96  84  0.13134217  0.02157962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  78  88 -0.12419976 -0.02102184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 101  82  0.10996109 -0.10266861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.01566968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.002200555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ATE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.01787023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $se.wtd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06627795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $approx.t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2696256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CI.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.1121915  0.1479319</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Random data with effect size -.2</span></span></span>
<span class="r-in"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">0</span>, <span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">6</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1000</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">aaa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">response</span>, <span class="va">treatment</span>, <span class="va">strata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">circ.psa</span><span class="op">(</span><span class="va">aaa</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="circ.psa-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary.strata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n.0 n.1     means.0  means.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 109  92  0.06061073 6.429138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 107  95  2.05044543 7.307719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  95 100 -0.51496035 6.621817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 102  92 -0.83491088 5.783739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  87 121  0.04153935 5.877122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1726229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.404157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ATE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.231534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $se.wtd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7560071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $approx.t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.242693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CI.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.747974 7.715095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Random data with effect size -2</span></span></span>
<span class="r-in"><span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">rt</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">3</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">rt</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">12</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">18</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>,<span class="st">"Y"</span>,<span class="st">"Z"</span>,<span class="st">"U"</span>,<span class="st">"V"</span><span class="op">)</span>, <span class="fl">200</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">circ.psa</span><span class="op">(</span><span class="va">response</span>, <span class="va">treatment</span>, <span class="va">strata</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="circ.psa-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary.strata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n.A n.B  means.A  means.B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> U  23  17 20.37282 19.12245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> V  25  22 20.65343 17.81284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X  17  30 19.76624 17.87898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Y  18  19 19.72954 17.57975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z  17  12 19.59112 17.94277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20.06386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18.06602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ATE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.997841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $se.wtd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3231541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $approx.t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -6.182318</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CI.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.635272 -1.360411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Tree derived strata</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart" class="external-link">rpart</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lindner</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/attach.html" class="external-link">attach</a></span><span class="op">(</span><span class="va">lindner</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from lindner (pos = 3):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     abcix, acutemi, cardbill, diabetic, ejecfrac, female, height,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lifepres, stent, ves1proc</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from lindner (pos = 4):</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     abcix, acutemi, cardbill, diabetic, ejecfrac, female, height,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     lifepres, stent, ves1proc</span>
<span class="r-in"><span><span class="va">lindner.rpart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></span><span class="op">(</span><span class="va">abcix</span> <span class="op">~</span> <span class="va">stent</span> <span class="op">+</span> <span class="va">height</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span> <span class="va">diabetic</span> <span class="op">+</span></span></span>
<span class="r-in"><span>     <span class="va">acutemi</span> <span class="op">+</span> <span class="va">ejecfrac</span> <span class="op">+</span> <span class="va">ves1proc</span>, data <span class="op">=</span> <span class="va">lindner</span>, method <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lindner.tree</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">lindner.rpart</span><span class="op">$</span><span class="va">where</span>, labels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">circ.psa</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cardbill</span><span class="op">)</span>, <span class="va">abcix</span>, <span class="va">lindner.tree</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="circ.psa-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary.strata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n.0 n.1  means.0  means.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  14   2 9.213456 9.653571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  29  16 9.278627 9.421610</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  58  87 9.507137 9.504301</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 131 256 9.397094 9.575469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  12  79 9.051331 9.427481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  54 258 9.472841 9.670249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.396949</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.57558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ATE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1786314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $se.wtd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05838647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $approx.t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.059466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CI.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06405511 0.29320771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##Loess derived strata</span></span></span>
<span class="r-in"><span><span class="va">lindner.ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">abcix</span> <span class="op">~</span> <span class="va">stent</span> <span class="op">+</span> <span class="va">height</span> <span class="op">+</span> <span class="va">female</span> <span class="op">+</span></span></span>
<span class="r-in"><span>      <span class="va">diabetic</span> <span class="op">+</span> <span class="va">acutemi</span> <span class="op">+</span> <span class="va">ejecfrac</span> <span class="op">+</span> <span class="va">ves1proc</span>,</span></span>
<span class="r-in"><span>      data <span class="op">=</span> <span class="va">lindner</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span><span class="op">&lt;-</span><span class="va">lindner.ps</span><span class="op">$</span><span class="va">fitted</span></span></span>
<span class="r-in"><span><span class="va">lindner.loess</span><span class="op">&lt;-</span><span class="fu"><a href="loess.psa.html">loess.psa</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cardbill</span><span class="op">)</span>, <span class="va">abcix</span>, <span class="va">ps</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="circ.psa-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">circ.psa</span><span class="op">(</span><span class="va">lindner.loess</span><span class="op">$</span><span class="va">summary.strata</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, summary <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      inc <span class="op">=</span> <span class="fl">.1</span>, labcex <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="circ.psa-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary.strata</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    counts.0 counts.1  means.0  means.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        58       42 9.338939 9.455965</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2        37       63 9.407877 9.503125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3        35       64 9.390499 9.540272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4        40       60 9.365029 9.574458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5        29       70 9.369748 9.593021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6        36       65 9.386188 9.604613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7        24       74 9.424611 9.616556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8        19       82 9.473078 9.612104</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9        11       87 9.559145 9.603100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10        9       91 9.707606 9.598751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.means.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.442172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wtd.Mn.means.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.570121</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ATE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1279487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $se.wtd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $approx.t</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> numeric(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 976</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $CI.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James Helmreich, Robert Pruzek, Jason Bryer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

